/**
* Package: angular-media-preview - v0.0.1 
* Description: create a preview for each media file given in input 
* Last build: 2016-10-12 
* @author codekraft-studio 
* @license ISC 
*/
angular.module("angular-media-preview",[]),angular.module("angular-media-preview").directive("mediaPreview",function($log,$document){function _link(scope,elem,attrs){function onChange(e){var files=$input[0].files;attrs.multiple?ngModel.$setViewValue(files):ngModel.$setViewValue(files[0]),container.empty(),files&&files.length&&angular.forEach(files,function(data,index){var result,$mediaElement,$reader=new FileReader;$reader.onloaderror=function(e){result=fallbackImage},$reader.onload=function(e){result=e.target.result},$reader.onloadend=function(e){result.indexOf("data:audio")>-1?($mediaElement=angular.element(document.createElement("audio")),$mediaElement.attr("controls","true")):result.indexOf("data:video")>-1?($mediaElement=angular.element(document.createElement("video")),$mediaElement.attr("controls","true")):$mediaElement=angular.element(document.createElement("img")),$mediaElement.attr("src",result),$mediaElement.addClass(previewClass),container.append($mediaElement)},$reader.readAsDataURL(data)})}var container,$input=angular.element(elem.children().eq(0)),ngModel=$input.controller("ngModel"),fallbackImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAA00lEQVR4Ae2XwQqDQAxEveinFD9e2MUfq6Cep7GnrPAg1JVCu5OTvEwe9FLtWlpqR6OyVn2aXbNGdX6KB4OLrmbRyIKsGsksWKsINhbUShM0wVcEk43CnAVY722mMEfBhPWD9mGOAlvBepSDwK1gPc5LASp8fbCJ81KACl9PNkOYo8CfKOtHUpijwJ841y1xToJy5VxXnLPgvUL1OAeBW4F6kKPAnYB6jKPAnYA68PZ/8EOCJtjvfvmdqwjSvR8gTz1YcCiytgs/TvLnvaDi/J2gCV63ZgZdEb12DwAAAABJRU5ErkJggg==",previewClass=attrs.previewClass||"media-preview",containerClass=attrs.containerClass||"media-container";"undefined"!=typeof attrs.multiple&&"false"!=attrs.multiple&&$input.attr("multiple",!0),attrs.previewContainer&&(document.getElementById(attrs.previewContainer)||angular.isElement(attrs.previewContainer))?container=angular.isElement(attrs.previewContainer)?attrs.previewContainer:angular.element(document.getElementById(attrs.previewContainer)):(container=angular.element(document.createElement("div")),elem.parent()[0].insertBefore(container[0],elem[0])),container.addClass(containerClass),scope.clearPreview=function(){$input.val(""),container.empty()},elem.on("change",onChange),scope.$on("$destroy",function(){elem.off("change",onChange)})}var directive={restrict:"E",scope:{model:"=?"},template:'<input type="file" accept="image/*,video/*,audio/*" ng-model="model" /><input type="button" ng-click="clearPreview()" value="X" />',link:_link};return directive});